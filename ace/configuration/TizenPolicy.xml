<policy-set id="Tizen-Policy" combine="first-matching-target">
    <policy id="Tizen-Policy-Partner-API" description="Partner API" combine="permit-overrides">
        <!-- Partner API. This is finger-print of tizen-distributor-root-ca-partner.pem -->
        <target>
            <subject>
                <subject-match attr="distributor-key-root-fingerprint" func="equal">
                    sha-1 67:37:DE:B7:B9:9D:D2:DB:A5:2C:42:DE:CB:2F:2C:3E:33:97:E1:85
                </subject-match>
            </subject>
        </target>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="tizen" />
            </condition>
        </rule>

        <!-- access to application -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="application.kill" />
                <resource-match attr="device-cap" func="equal" match="application.launch" />
                <resource-match attr="device-cap" func="equal" match="application.read" />
            </condition>
        </rule>

        <!-- access to bluetooth -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="bluetooth.admin" />
                <resource-match attr="device-cap" func="equal" match="bluetooth.gap" />
                <resource-match attr="device-cap" func="equal" match="bluetooth.spp" />
            </condition>
        </rule>

        <!-- access to calendar -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="calendar.read" />
                <resource-match attr="device-cap" func="equal" match="calendar.write" />
            </condition>
        </rule>

        <!-- access to call history -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="callhistory.read" />
                <resource-match attr="device-cap" func="equal" match="callhistory.write" />
            </condition>
        </rule>

        <!-- access to contact -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="contact.read" />
                <resource-match attr="device-cap" func="equal" match="contact.write" />
            </condition>
        </rule>

        <!-- access to content -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="content.read" />
                <resource-match attr="device-cap" func="equal" match="content.write" />
            </condition>
        </rule>

        <!-- access to NFC -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="nfc.admin" />
                <resource-match attr="device-cap" func="equal" match="nfc.tag" />
                <resource-match attr="device-cap" func="equal" match="nfc.p2p" />
                <resource-match attr="device-cap" func="equal" match="nfc.cardemulation" />
                <resource-match attr="device-cap" func="equal" match="nfc.common" />
            </condition>
        </rule>

        <!-- access to systeminfo -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="systeminfo" />
            </condition>
        </rule>

        <!-- access to system setting -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="setting" />
            </condition>
        </rule>

        <!-- access to download feature -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="download" />
            </condition>
        </rule>

        <!-- access to power feature -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="power" />
            </condition>
        </rule>

        <!-- access to push feature -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="push" />
            </condition>
        </rule>

        <!-- access to timeutil -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="time" />
            </condition>
        </rule>

        <!-- access to external network -->
        <!-- XMLHttpRequestTizen and externalNetworkAccessTizen defined for Tizen Webapp -->
        <!-- Function of two capabilities are same to XMLHttpRequest and externalNetworkAccess of WAC -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="XMLHttpRequest" />
                <resource-match attr="device-cap" func="equal" match="externalNetworkAccess" />
            </condition>
        </rule>

        <!-- access to external network on roaming status -->
        <rule effect="permit">
            <condition combine="and">
                <condition combine="or">
                    <resource-match attr="device-cap" func="equal" match="XMLHttpRequest" />
                    <resource-match attr="device-cap" func="equal" match="externalNetworkAccess" />
                </condition>
                <environment-match attr="roaming" match="true" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="alarm" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="log" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="messaging.read" />
                <resource-match attr="device-cap" func="equal" match="messaging.write" />
                <resource-match attr="device-cap" func="equal" match="messaging.send" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="filesystem.read" />
                <resource-match attr="device-cap" func="equal" match="filesystem.write" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="notification.read" />
                <resource-match attr="device-cap" func="equal" match="notification.write" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="networkbearerselection" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="datacontrol.consumer" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="se" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="account.read" />
				<resource-match attr="device-cap" func="equal" match="account.write" />
            </condition>
        </rule>

        <rule effect="deny" />
    </policy>
    <policy id="Tizen-Policy-Trusted" description="Tizen's policy for trusted domain" combine="permit-overrides">
        <!-- This is finger-print of certificate for TIZEN SDK (tizen.root.preproduction.cert.pem) --> 
        <target>
            <subject>
                <subject-match attr="distributor-key-root-fingerprint" func="equal">
                    sha-1 AD:A1:44:89:6A:35:6D:17:01:E9:6F:46:C6:00:7B:78:BE:2E:D9:4E
                </subject-match>
            </subject>
        </target> 

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="tizen" />
            </condition>
        </rule>

        <!-- access to application -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="application.launch" />
                <resource-match attr="device-cap" func="equal" match="application.read" />
            </condition>
        </rule>

        <!-- access to bluetooth -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="bluetooth.admin" />
                <resource-match attr="device-cap" func="equal" match="bluetooth.gap" />
                <resource-match attr="device-cap" func="equal" match="bluetooth.spp" />
            </condition>
        </rule>

        <!-- access to calendar -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="calendar.read" />
                <resource-match attr="device-cap" func="equal" match="calendar.write" />
            </condition>
        </rule>

        <!-- access to call history -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="callhistory.read" />
                <resource-match attr="device-cap" func="equal" match="callhistory.write" />
            </condition>
        </rule>

        <!-- access to contact -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="contact.read" />
                <resource-match attr="device-cap" func="equal" match="contact.write" />
            </condition>
        </rule>

        <!-- access to content -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="content.read" />
                <resource-match attr="device-cap" func="equal" match="content.write" />
            </condition>
        </rule>

        <!-- access to NFC -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="nfc.admin" />
                <resource-match attr="device-cap" func="equal" match="nfc.tag" />
                <resource-match attr="device-cap" func="equal" match="nfc.p2p" />
                <resource-match attr="device-cap" func="equal" match="nfc.cardemulation" />
                <resource-match attr="device-cap" func="equal" match="nfc.common" />
            </condition>
        </rule>

        <!-- access to systeminfo -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="systeminfo" />
            </condition>
        </rule>

        <!-- access to system setting -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="setting" />
            </condition>
        </rule>

        <!-- access to download feature -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="download" />
            </condition>
        </rule>

        <!-- access to power feature -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="power" />
            </condition>
        </rule>

        <!-- access to push feature -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="push" />
            </condition>
        </rule>

        <!-- access to timeutil -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="time" />
            </condition>
        </rule>

        <!-- access to external network -->
        <!-- XMLHttpRequestTizen and externalNetworkAccessTizen defined for Tizen Webapp -->
        <!-- Function of two capabilities are same to XMLHttpRequest and externalNetworkAccess of WAC -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="XMLHttpRequest" />
                <resource-match attr="device-cap" func="equal" match="externalNetworkAccess" />
            </condition>
        </rule>

        <!-- access to external network on roaming status -->
        <rule effect="permit">
            <condition combine="and">
                <condition combine="or">
                    <resource-match attr="device-cap" func="equal" match="XMLHttpRequest" />
                    <resource-match attr="device-cap" func="equal" match="externalNetworkAccess" />
                </condition>
                <environment-match attr="roaming" match="true" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="alarm" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="log" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="messaging.read" />
                <resource-match attr="device-cap" func="equal" match="messaging.write" />
                <resource-match attr="device-cap" func="equal" match="messaging.send" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="filesystem.read" />
                <resource-match attr="device-cap" func="equal" match="filesystem.write" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="notification.read" />
                <resource-match attr="device-cap" func="equal" match="notification.write" />
            </condition>
        </rule>

        <rule effect="deny" />
    </policy>

    <policy id="Tizen-Policy-Untrusted" description="Tizen's policy for untrusted domain" combine="permit-overrides">
        <!-- Specific Untrusted Policy for Tizen -->

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="tizen" />
            </condition>
        </rule>

        <!-- access to application -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="application.launch" />
                <resource-match attr="device-cap" func="equal" match="application.read" />
            </condition>
        </rule>

        <!-- access to bluetooth -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="bluetooth.admin" />
                <resource-match attr="device-cap" func="equal" match="bluetooth.gap" />
                <resource-match attr="device-cap" func="equal" match="bluetooth.spp" />
            </condition>
        </rule>

        <!-- access to calendar -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="calendar.read" />
                <resource-match attr="device-cap" func="equal" match="calendar.write" />
            </condition>
        </rule>

        <!-- access to call history -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="callhistory.read" />
                <resource-match attr="device-cap" func="equal" match="callhistory.write" />
            </condition>
        </rule>

        <!-- access to contact -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="contact.read" />
                <resource-match attr="device-cap" func="equal" match="contact.write" />
            </condition>
        </rule>

        <!-- access to content -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="content.read" />
                <resource-match attr="device-cap" func="equal" match="content.write" />
            </condition>
        </rule>

        <!-- access to NFC -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="nfc.admin" />
                <resource-match attr="device-cap" func="equal" match="nfc.tag" />
                <resource-match attr="device-cap" func="equal" match="nfc.p2p" />
                <resource-match attr="device-cap" func="equal" match="nfc.cardemulation" />
                <resource-match attr="device-cap" func="equal" match="nfc.common" />
            </condition>
        </rule>

        <!-- access to systeminfo -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="systeminfo" />
            </condition>
        </rule>

        <!-- access to system setting -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="setting" />
            </condition>
        </rule>

        <!-- access to download feature -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="download" />
            </condition>
        </rule>

        <!-- access to power feature -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="power" />
            </condition>
        </rule>

        <!-- access to push feature -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="push" />
            </condition>
        </rule>

        <!-- access to timeutil -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="time" />
            </condition>
        </rule>

        <!-- access to external network -->
        <!-- XMLHttpRequestTizen and externalNetworkAccessTizen defined for Tizen Webapp -->
        <!-- Function of two capabilities are same to XMLHttpRequest and externalNetworkAccess of WAC -->
        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="XMLHttpRequest" />
                <resource-match attr="device-cap" func="equal" match="externalNetworkAccess" />
            </condition>
        </rule>

        <!-- access to external network on roaming status -->
        <rule effect="permit">
            <condition combine="and">
                <condition combine="or">
                    <resource-match attr="device-cap" func="equal" match="XMLHttpRequest" />
                    <resource-match attr="device-cap" func="equal" match="externalNetworkAccess" />
                </condition>
                <environment-match attr="roaming" match="true" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="alarm" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="log" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="messaging.read" />
                <resource-match attr="device-cap" func="equal" match="messaging.write" />
                <resource-match attr="device-cap" func="equal" match="messaging.send" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="filesystem.read" />
                <resource-match attr="device-cap" func="equal" match="filesystem.write" />
            </condition>
        </rule>

        <rule effect="permit">
            <condition combine="or">
                <resource-match attr="device-cap" func="equal" match="notification.read" />
                <resource-match attr="device-cap" func="equal" match="notification.write" />
            </condition>
        </rule>

        <rule effect="deny" />
    </policy>
</policy-set>
